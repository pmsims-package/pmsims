---
title: "Hello World: A simple example"
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(pmsims)
set.seed(42)
# devtools::install_github("flxzimmer/mlpwr", ref = "pmsims")

```

# Hello World

Here we give the simplest example of using `pmsims`.

Imagine you are an analyst planning on developing a prediction model for Type
2 diabetes based on a novel bio marker. You know that the best existing
prediction models have c-statistic of around 0.8. You'll need to recruit new
patients to develop your model, and want to know how many patients to recruit.

You are treating onset of Type 2 diabetes as a binary outcome. We will use the
default data generator for binary outcome, which assumes 10 predictors and uses
logistic regression to develop the model. You'd like the c-statistic to be
within 0.02 of the model performance possible in a large dataset (ie. target
performance of 0.78 vs large sample performance of 0.8).

To use `pmsims::calculate_sample_size` to get a sample size estimate you run:

```{r}
set.seed(42)
s_mlpwr <- simulate_binary(
  signal_parameters = 10,
  baseline_prob = 0.1,
  large_sample_performance = 0.8,
  min_sample_size = 100,
  max_sample_size = 5000,
  method = "mlpwr"  # <----------
)

summary(s_mlpwr)

s_crude <- simulate_binary(
  signal_parameters = 10,
  baseline_prob = 0.1,
  large_sample_performance = 0.8,
  min_sample_size = 100,
  max_sample_size = 5000,
  method = "crude"  # <----------
)

summary(s_crude)
```

The minimum sample size is `r sample_size$min_n`.

```{r}
sample_size <- simulate_binary(parameters = 20,
                               prevalence = 0.5, # Currently doing nothing, I think.
                               cstatistic = 0.75,
                               min_sample_size = 200,
                               max_sample_size = 8000)

summary(sample_size)
```

```{r}
set.seed(42)

fit_glm <- simulate_continuous(
  signal_parameters = 100,
  large_sample_performance = 0.8,
  min_sample_size = 100,
  max_sample_size = 5000
)

fit_lasso <- simulate_binary(
  signal_parameters = 10,
  baseline_prob = 0.1,
  large_sample_performance = 0.8,
  min_sample_size = 100,
  max_sample_size = 5000,
  model = "lasso"
)

fit_rf <- simulate_binary(
  signal_parameters = 10,
  baseline_prob = 0.1,
  large_sample_performance = 0.8,
  min_sample_size = 100,
  max_sample_size = 5000,
  model = "rf"
)



```
